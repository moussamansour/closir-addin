{"version":3,"file":"settings.js","mappings":"YAaA,SAASA,IACP,IAAIC,EAAQC,SAASC,eAAe,SAASC,MAE7CC,OAAOC,QAAQC,QAAQC,KAAKC,UAAUC,UAAS,SAAkBC,GAC/D,IACE,IAAIC,EAAQD,EAAOP,MAAMS,aACRC,MAAM,0DAA4DF,EAAO,CACxFG,OAAQ,MACRC,QAAS,CACP,eAAgB,sBAGXC,MAAK,SAACC,GACbA,EAAKC,OAAOF,MAAK,SAACN,GACZA,GACEA,EAAc,OAAKV,GACrBC,SAASC,eAAe,kBAAkBiB,MAAMC,QAAU,OAC1DhB,OAAOC,QAAQgB,gBAAgBC,IAAI,iBAAkBtB,GACrDI,OAAOC,QAAQgB,gBAAgBE,WAAU,SAAUb,GAC7CA,EAAOc,QAAUpB,OAAOqB,kBAAkBC,WAE5CzB,SAASC,eAAe,cAAcyB,UAAY,SAClD1B,SAASC,eAAe,mBAAmBiB,MAAMC,QAAU,QAC3DQ,YAAW,WACT3B,SAASC,eAAe,mBAAmBiB,MAAMC,QAAU,MAC7D,GAAG,KACHS,QAAQC,IAAI,8BAGZD,QAAQC,IAAI,uBAAyBpB,EAAOqB,MAAMC,QAEtD,KAKF/B,SAASC,eAAe,kBAAkBiB,MAAMC,QAAU,OAE9D,GACF,GACF,CAAE,MAAOa,GACPJ,QAAQC,IAAIG,GACZhC,SAASC,eAAe,kBAAkBiB,MAAMC,QAAU,OAC5D,CACF,GACF,CAxDAhB,OAAO8B,SAAQ,SAACC,GACVA,EAAKC,OAAShC,OAAOiC,SAASC,UAChCrC,SAASC,eAAe,mBAAmBiB,MAAMC,QAAU,OACvDhB,OAAOC,QAAQgB,gBAAgBkB,IAAI,oBACrCtC,SAASC,eAAe,SAASC,MAAQC,OAAOC,QAAQgB,gBAAgBkB,IAAI,kBAC5EtC,SAASC,eAAe,cAAcyB,UAAY,UAEpD1B,SAASC,eAAe,cAAcsC,QAAUzC,EAEpD,G","sources":["webpack://office-addin-taskpane-js/./src/settings/settings.js"],"sourcesContent":["/* global document, Office */\n\nOffice.onReady((info) => {\n  if (info.host === Office.HostType.Outlook) {\n    document.getElementById(\"success-message\").style.display = \"none\";\n    if (Office.context.roamingSettings.get(\"closir_token39\")) {\n      document.getElementById(\"token\").value = Office.context.roamingSettings.get(\"closir_token39\");\n      document.getElementById(\"saveButton\").innerHTML = \"Update\";\n    }\n    document.getElementById(\"saveButton\").onclick = saveToken;\n  }\n});\n// Function to save the token\nfunction saveToken() {\n  var token = document.getElementById(\"token\").value;\n  // Save the token in add-on settings\n  Office.context.mailbox.item.organizer.getAsync(function callback(result) {\n    try {\n      let email = result.value.emailAddress;\n      const response = fetch(\"https://www.closir.com/api/public/token?requesterEmail=\" + email, {\n        method: \"GET\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n      });\n      response.then((data) => {\n        data.json().then((result) => {\n          if (result) {\n            if (result[\"token\"] == token) {\n              document.getElementById(\"failed-message\").style.display = \"none\";\n              Office.context.roamingSettings.set(\"closir_token39\", token);\n              Office.context.roamingSettings.saveAsync(function (result) {\n                if (result.status == Office.AsyncResultStatus.Succeeded) {\n                  // Token saved successfully, provide feedback to the user\n                  document.getElementById(\"saveButton\").innerHTML = \"Update\";\n                  document.getElementById(\"success-message\").style.display = \"block\";\n                  setTimeout(() => {\n                    document.getElementById(\"success-message\").style.display = \"none\";\n                  }, 5000);\n                  console.log(\"Token saved successfully!\");\n                } else {\n                  // Handle error\n                  console.log(\"Error saving token: \" + result.error.message);\n                }\n              });\n            } else {\n              document.getElementById(\"failed-message\").style.display = \"block\";\n            }\n          } else {\n            document.getElementById(\"failed-message\").style.display = \"block\";\n          }\n        });\n      });\n    } catch (e) {\n      console.log(e);\n      document.getElementById(\"failed-message\").style.display = \"block\";\n    }\n  });\n}\n"],"names":["saveToken","token","document","getElementById","value","Office","context","mailbox","item","organizer","getAsync","result","email","emailAddress","fetch","method","headers","then","data","json","style","display","roamingSettings","set","saveAsync","status","AsyncResultStatus","Succeeded","innerHTML","setTimeout","console","log","error","message","e","onReady","info","host","HostType","Outlook","get","onclick"],"sourceRoot":""}